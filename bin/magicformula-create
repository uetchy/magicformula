#!/usr/bin/env node

var prompt = require('prompt');
var optimist = require('optimist');

// Load plugins
var plugins = [require('../lib/plugin/base'), require('../lib/plugin/binary')];

optimist.usage('Usage: $0 [options...]');

var props = [];

plugins.forEach((plugin) => {
  plugin.props.forEach((prop) => {
    optimist.options(prop.name, prop);
    props.push(prop);
  });
});

var argv = optimist.argv;

prompt.override = optimist.argv
prompt.start();
prompt.get(props, function(err, result) {
  for (var key in result) {
    argv[key] = result[key];
  }
  var formula = {};

  plugins.forEach((plugin) => {
    formula = plugin.call(argv, formula);
  });

  console.log(formula);
});
